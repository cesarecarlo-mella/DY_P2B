(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63524,       1560]
NotebookOptionsPosition[     59410,       1493]
NotebookOutlinePosition[     59907,       1512]
CellTagsIndexPosition[     59864,       1509]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.860576928226026*^9, 3.86057693007786*^9}, {
  3.861846397535225*^9, 3.861846405398551*^9}, {3.874130402384742*^9, 
  3.874130403436799*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b556ad24-c42c-47b9-87a8-161a44cd21e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.860576961023477*^9, 3.860576991709044*^9}, 
   3.964584375003424*^9, 3.964594452761574*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"1747bd0d-604b-4f10-99e7-0fe6fa4529fc"],

Cell[BoxData["\<\"/Users/cesarecarlomella/Desktop/Physics/PhD/DY/N3LO/RRR/\
mappings\"\>"], "Output",
 CellChangeTimes->{
  3.861777745880982*^9, 3.861779936230109*^9, 3.861780840272312*^9, 
   3.861781989344177*^9, 3.861785432422192*^9, 3.861845420488515*^9, 
   3.861846413874029*^9, 3.86185147740457*^9, 3.861854315237054*^9, 
   3.8619603725157948`*^9, 3.862883567427835*^9, 3.8628840677842627`*^9, 
   3.862884243598819*^9, 3.862890353984751*^9, 3.862891866832196*^9, 
   3.86289200612307*^9, {3.862892718006922*^9, 3.86289273410562*^9}, 
   3.872759960450463*^9, 3.872760704667288*^9, 3.872826248657795*^9, 
   3.873185893045277*^9, 3.873248776151828*^9, 3.873250353268234*^9, 
   3.873265988064311*^9, 3.873340649050358*^9, 3.873340761528013*^9, 
   3.873421333707898*^9, 3.873965494054429*^9, 3.874028083184701*^9, 
   3.874119369344619*^9, 3.874125162362095*^9, 3.874130409214924*^9, 
   3.874372818413562*^9, 3.87440570201245*^9, 3.874406097365937*^9, 
   3.874457682398074*^9, 3.874459221886222*^9, 3.8744605846795588`*^9, 
   3.874468684831892*^9, 3.874469255306696*^9, 3.874469431140043*^9, 
   3.874476842128603*^9, 3.875938851841771*^9, 3.875945828383796*^9, 
   3.876367600585875*^9, 3.87639369423765*^9, 3.876448153654731*^9, 
   3.876479276662809*^9, {3.876536170804311*^9, 3.876536174577991*^9}, 
   3.876536733733862*^9, 3.876545168839193*^9, 3.876545699762498*^9, 
   3.876545904338359*^9, 3.87656385377044*^9, 3.876794202442696*^9, 
   3.876795050374922*^9, 3.876796142352642*^9, 3.876801375992533*^9, 
   3.8768110764593*^9, 3.876881114963356*^9, 3.914491871198494*^9, 
   3.9145495741460447`*^9, 3.914819645972756*^9, 3.915424468145602*^9, 
   3.915425971373014*^9, 3.915426645208808*^9, 3.915426796943892*^9, 
   3.91542833652053*^9, 3.915458372955003*^9, 3.91545905045567*^9, 
   3.915586924428947*^9, 3.915633730823792*^9, 3.916979233233737*^9, 
   3.918099642135168*^9, 3.918113037195385*^9, 3.918639518381938*^9, 
   3.918706295783627*^9, 3.918811594767715*^9, 3.919343696610702*^9, 
   3.921291826255871*^9, 3.921297867380972*^9, 3.921467424666312*^9, 
   3.921558996441557*^9, 3.9229517246955214`*^9, 3.922968329696837*^9, {
   3.923017206981924*^9, 3.923017210239518*^9}, 3.923019556567148*^9, 
   3.92301959126689*^9, 3.923044697835738*^9, 3.923127232046665*^9, 
   3.923321488785548*^9, 3.923622096519618*^9, 3.923622208400962*^9, 
   3.923645804631569*^9, 3.9236650129977093`*^9, 3.92366524828646*^9, 
   3.923705321155387*^9, {3.923832941211968*^9, 3.923832948010223*^9}, 
   3.9238861319437523`*^9, 3.924009639491223*^9, 3.924184422940476*^9, 
   3.92450167164937*^9, 3.924916619012644*^9, 3.924916970241832*^9, 
   3.924943950303765*^9, 3.924961310230379*^9, 3.924963509621137*^9, 
   3.925004349054805*^9, 3.925004452948908*^9, 3.925022314392116*^9, 
   3.925809817615765*^9, 3.9260418681435227`*^9, {3.926167932272806*^9, 
   3.926167938637369*^9}, {3.926490108201861*^9, 3.926490132798024*^9}, 
   3.926510177949274*^9, 3.927022738652254*^9, 3.927073704229771*^9, {
   3.928396300585603*^9, 3.928396308624699*^9}, 3.928505250303932*^9, 
   3.930047061257544*^9, {3.93010837713087*^9, 3.930108381531063*^9}, {
   3.930149073906767*^9, 3.930149092704197*^9}, 3.930272499780414*^9, 
   3.93027766460752*^9, 3.930282658802812*^9, 3.930487213513229*^9, 
   3.930536617289185*^9, {3.951837544731236*^9, 3.951837548188969*^9}, 
   3.951873289785433*^9, 3.951876786892542*^9, 3.951877586316587*^9, 
   3.951881684847356*^9, 3.9519035300766077`*^9, 3.951921525428754*^9, {
   3.951969381251152*^9, 3.951969384677593*^9}, 3.951976797166778*^9, {
   3.9520042077305*^9, 3.952004210457294*^9}, 3.952005752240713*^9, 
   3.952005792813143*^9, 3.95200590368481*^9, 3.952009899940431*^9, 
   3.952051306327724*^9, 3.9525198386581373`*^9, 3.952520305118828*^9, 
   3.95325160569058*^9, 3.9532636670251913`*^9, 3.953268784326597*^9, 
   3.953368723814345*^9, 3.953714267679294*^9, 3.9546401829799*^9, {
   3.9546450269154577`*^9, 3.954645029630122*^9}, 3.95464506097287*^9, 
   3.954645157275786*^9, 3.954679604536312*^9, 3.954771740149097*^9, 
   3.954819595502873*^9, 3.954834450288353*^9, 3.9548376315217533`*^9, 
   3.954857751859692*^9, 3.955075222519039*^9, 3.955081066097665*^9, 
   3.955084172189452*^9, 3.955085290010882*^9, 3.9550853523483047`*^9, 
   3.958443704168404*^9, 3.958460516168523*^9, {3.958460976092863*^9, 
   3.958460979265518*^9}, 3.958461310000724*^9, 3.958648746041692*^9, {
   3.964576013320944*^9, 3.964576017373538*^9}, 3.964580262051793*^9, 
   3.964581684869701*^9, 3.964582386942405*^9, 3.964583099592592*^9, 
   3.9645843773528156`*^9, 3.964594454952082*^9, 3.96466222568872*^9, 
   3.9646667118762913`*^9, 3.964755545579911*^9, 3.965291299319322*^9, 
   3.965291345180094*^9, 3.96589580702363*^9, 3.965958105849598*^9, 
   3.965958351929769*^9, {3.965958492691928*^9, 3.965958495404963*^9}, {
   3.965964131770653*^9, 3.965964160595357*^9}, 3.9699351922367477`*^9, 
   3.969942440713731*^9, 3.969954782168481*^9, 3.969956544736225*^9, 
   3.971331838313393*^9, 3.971341651436968*^9, 3.971417137627171*^9, 
   3.9714228092335043`*^9, 3.971424546990849*^9, 3.971425212546001*^9, 
   3.971425662855762*^9, 3.9714967052829638`*^9, 3.9724565546911583`*^9, 
   3.972457638841312*^9, 3.972459281921029*^9, 3.9724619047973137`*^9, {
   3.972463243697267*^9, 3.9724632508923903`*^9}, {3.9725251663664093`*^9, 
   3.9725251760994673`*^9}, 3.972531204646245*^9, 3.972896884007159*^9, 
   3.973073124126478*^9, {3.973335055352512*^9, 3.973335060759066*^9}, 
   3.973566565388509*^9, 3.973571030249056*^9, 3.97357163421067*^9, 
   3.973572638225398*^9, 3.973681734204661*^9, 3.973762590045855*^9, 
   3.973935190679772*^9, 3.974106597086625*^9, 3.974113032609326*^9, 
   3.97411400142633*^9, 3.974114765484714*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"bc745a2c-7261-43c8-b6f3-9d86b14dcc13"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qqbVggg", "[", "vv", "]"}], "=", 
   RowBox[{
   "Import", "[", "\"\<../rrr.results/qqbVggg/vv/unreduced1.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.974113077948173*^9, 3.974113097462317*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b6e19f8b-9906-4a7c-8f5e-adf550d52f12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"buildInfo", "[", "int_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", "t", ",", "r", ",", "s", ",", "bin", ",", "scalar", ",", 
      "secID"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"int", " ", "/.", " ", 
            RowBox[{"INT", " ", "->", " ", "List"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}], " ", "/.", " ", 
         RowBox[{
          RowBox[{"a_", " ", "/;", " ", 
           RowBox[{"a", ">", " ", "0"}]}], " ", "->", " ", "0"}]}], "//", 
        "Total"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"int", " ", "/.", " ", 
            RowBox[{"INT", " ", "->", " ", "List"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}], " ", "/.", " ", 
         RowBox[{
          RowBox[{"a_", " ", "/;", " ", 
           RowBox[{"a", "<", "0"}]}], " ", "->", " ", "0"}]}], " ", "/.", " ", 
        RowBox[{
         RowBox[{"a_", " ", "/;", " ", 
          RowBox[{"a", ">", " ", "1"}]}], " ", "->", " ", "1"}]}], "//", 
       "Total"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"int", " ", "/.", " ", 
           RowBox[{"INT", " ", "->", " ", "List"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}], " ", "/.", " ", 
        RowBox[{
         RowBox[{"a_", " ", "/;", " ", 
          RowBox[{"a", "<", "0"}]}], " ", "->", " ", "0"}]}], "//", 
       "Total"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bin", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"int", " ", "/.", " ", 
         RowBox[{"INT", " ", "->", " ", "List"}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
     
     RowBox[{"scalar", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bin", " ", "/.", " ", 
         RowBox[{
          RowBox[{"a_", " ", "/;", " ", 
           RowBox[{"a", "<", "0"}]}], " ", "->", " ", "0"}]}], "  ", "/.", 
        " ", 
        RowBox[{
         RowBox[{"a_", " ", "/;", " ", 
          RowBox[{"a", ">", " ", "1"}]}], " ", "->", " ", "1"}]}], ")"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"secID", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"scalar", "[", 
          RowBox[{"[", "i", "]"}], "]"}], 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "scalar", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"int", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "t", ",", "r", ",", "s", ",",
         "secID", ",", " ", "bin"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"e489dccb-fc0c-4cc8-8c81-4ec0f8e6300b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"intsall", "=", 
   RowBox[{"Union", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"qqbVggg", "[", "vv", "]"}], ",", " ", "_INT", ",", " ", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infointsall", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"buildInfo", "[", "#", "]"}], "&"}], "/@", "intsall"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9741131142606277`*^9, 3.974113197494391*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6cb6b0b4-10c5-4c7f-9ac1-6e42f3571ba5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "intsall", "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"dde2e4c4-0179-4e3f-86ea-3bcbf676f011"],

Cell[BoxData["164274"], "Output",
 CellChangeTimes->{3.9741132040774183`*^9, 3.9741140263847437`*^9, 
  3.9741147872779083`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"f94cbd75-cbef-4101-ab4f-6bd1efc938f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intsall", "[", 
  RowBox[{"[", 
   RowBox[{";;", "10"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.974113428047233*^9, 3.974113448384653*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ffad7af3-783c-486e-856e-8c7b7d63477c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "2"}], ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"INT", "[", 
    RowBox[{"topo1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", "0", ",", 
     RowBox[{"-", "2"}], ",", "0", ",", "1", ",", "1"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.974113426984516*^9, 3.974113448712943*^9}, 
   3.974114026412428*^9, 3.974114787301405*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"9889dd36-1719-4bc8-8e94-279aa609b6a9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"intsallNoTopo1", "=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{"intsall", ",", 
     RowBox[{"Union", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"intsall", ",", " ", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{"fam_", ",", "bin__"}], "]"}], "/;", " ", 
         RowBox[{"fam", " ", "===", " ", "topo1"}]}], ",", "\[Infinity]"}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.974113392993376*^9, 3.9741134323508873`*^9}, {
  3.974113986539496*^9, 3.97411399679136*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"0523a8ab-a457-479e-9486-44f54619357b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullFamilies", "=", " ", 
   RowBox[{
   "Import", "[", "\"\<../Families_Identification/Families.m\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetryRelated", "=", 
   RowBox[{
   "Import", 
    "[", "\"\<../Families_Identification/SYMMETRY_RELABELLING/symmetryRelated.\
m\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WhichMapped", "=", 
   RowBox[{
   "Import", 
    "[", "\"\<../Families_Identification/SYMMETRY_RELABELLING/WhichMapped.m\>\
\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetryRelatedSectors", "=", 
   RowBox[{"symmetryRelated", " ", "/.", " ", 
    RowBox[{
     RowBox[{"INT", "[", 
      RowBox[{"fam_", ",", " ", 
       RowBox[{"{", "bin__", "}"}]}], "]"}], ":>", " ", 
     RowBox[{"INT", "[", 
      RowBox[{"fam", ",", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "bin", "}"}], " ", "/.", " ", 
            RowBox[{"_nisp", " ", ":>", " ", "0"}]}], " ", "/.", " ", 
           RowBox[{"_n", ":>", " ", "1"}]}], "]"}], ",", "2"}], "]"}], ",", 
       " ", 
       RowBox[{"{", "bin", "}"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topoToN", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<topo\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", "i"}], "]"}], 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "300"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"sp", ",", " ", "Orderless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sp", "[", 
   RowBox[{
    RowBox[{"a_Integer", " ", "b_"}], ",", " ", "c_"}], "]"}], ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"sp", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sp", "[", 
   RowBox[{
    RowBox[{"a_Rational", " ", "b_"}], ",", " ", "c_"}], "]"}], ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"sp", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sp", "[", 
   RowBox[{
    RowBox[{"a_Complex", " ", "b_"}], ",", " ", "c_"}], "]"}], ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"sp", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sp", "[", 
   RowBox[{"a_", " ", ",", " ", 
    RowBox[{"b_", " ", "+", " ", "c_"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"sp", "[", 
    RowBox[{"a", ",", "b"}], "]"}], " ", "+", " ", 
   RowBox[{"sp", "[", 
    RowBox[{"a", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VectorContractions", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f_", "[", "mu_", "]"}], 
      RowBox[{"g_", "[", "mu_", "]"}]}], " ", ":>", " ", 
     RowBox[{"sp", "[", 
      RowBox[{"f", ",", "g"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"q_", "[", "mu_", "]"}], "^", "2"}], " ", ":>", 
     RowBox[{"sp", "[", " ", 
      RowBox[{"q", ",", "q"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"TransverseTensor", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"mu_", ",", "nu_", ",", "q_"}], "]"}], " ", "->", " ", 
    RowBox[{"-", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"mu", ",", "nu"}], "]"}], "-", 
       RowBox[{
        RowBox[{"q", "[", "mu", "]"}], 
        RowBox[{
         RowBox[{"q", "[", "nu", "]"}], "/", 
         RowBox[{"sp", "[", 
          RowBox[{"q", ",", "q"}], "]"}]}]}]}], ")"}]}]}], " ", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"kin", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"p1", ",", "p1"}], "]"}], "->", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"p2", ",", "p2"}], "]"}], "->", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], " ", "->", " ", 
     RowBox[{"s12", "/", "2"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denoms", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"on", "-", 
      RowBox[{"shell", " ", "cut", " ", "propagators"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DD1", "->", 
      RowBox[{"sp", "[", 
       RowBox[{"r1", ",", "r1"}], "]"}]}], ",", 
     RowBox[{"DD2", "->", 
      RowBox[{"sp", "[", 
       RowBox[{"r2", ",", "r2"}], "]"}]}], ",", 
     RowBox[{"DD3", "->", 
      RowBox[{"sp", "[", 
       RowBox[{"r3", ",", "r3"}], "]"}]}], ",", 
     RowBox[{"DD4", "->", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         RowBox[{"p1", "+", "p2", "+", "r1", "+", "r2", "+", "r3"}], ",", 
         RowBox[{"p1", "+", "p2", "+", "r1", "+", "r2", "+", "r3"}]}], "]"}], 
       "-", "m2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"cut", " ", "rapidity", " ", "propagator"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DD5", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"q", ",", 
               RowBox[{
                RowBox[{"-", "p1"}], "+", 
                RowBox[{"u", " ", "p2"}]}]}], "]"}], "/.", 
             RowBox[{
              RowBox[{"sp", "[", 
               RowBox[{"a_", ",", 
                RowBox[{"u", " ", "b_"}]}], "]"}], ":>", 
              RowBox[{"u", " ", 
               RowBox[{"sp", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}]}]}], "/.", 
            RowBox[{"q", "->", 
             RowBox[{
              RowBox[{"-", "p1"}], "-", "p2", "-", "r1", "-", "r2", "-", 
              "r3"}]}]}], "/.", "kin"}], " ", "/.", " ", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "p1"}], "-", "p2", "-", "r1", "-", "r2", "-", 
              "r3"}], ",", "a_"}], "]"}], " ", "->", 
           RowBox[{"-", 
            RowBox[{"sp", "[", 
             RowBox[{
              RowBox[{
              "p1", "+", "p2", "+", "r1", "+", "r2", " ", "-", " ", "r3"}], ",",
               "a"}], "]"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a__", ",", 
            RowBox[{"-", "p1"}]}], "]"}], " ", "->", 
          RowBox[{"-", 
           RowBox[{"sp", "[", 
            RowBox[{"a", ",", "p1"}], "]"}]}]}]}], "//", "Expand"}], ")"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"DD6", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r1"}], ",", 
        RowBox[{"p1", "+", "r1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD7", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r1"}], ",", 
        RowBox[{"p2", "+", "r1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD8", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r2"}], ",", 
        RowBox[{"p1", "+", "r2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD9", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r2"}], ",", 
        RowBox[{"p2", "+", "r2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD10", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r3"}], ",", 
        RowBox[{"p1", "+", "r3"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD11", " ", "->", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r3"}], ",", 
        RowBox[{"p2", "+", "r3"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD12", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"r1", "+", "r2"}], ",", 
        RowBox[{"r1", "+", "r2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD13", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"r2", "+", "r3"}], ",", 
        RowBox[{"r2", "+", "r3"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD14", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"r1", "+", "r3"}], ",", 
        RowBox[{"r1", "+", "r3"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"DD15", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r1", "+", "r2"}], ",", 
        RowBox[{"p1", "+", "r1", "+", "r2"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD16", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r1", "+", "r2"}], ",", 
        RowBox[{"p2", "+", "r1", "+", "r2"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD17", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r1", "+", "r3"}], ",", 
        RowBox[{"p1", "+", "r1", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD18", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r1", "+", "r3"}], ",", 
        RowBox[{"p2", "+", "r1", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD19", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r2", "+", "r3"}], ",", 
        RowBox[{"p1", "+", "r2", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD20", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r2", "+", "r3"}], ",", 
        RowBox[{"p2", "+", "r2", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD21", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"r1", "+", "r2", "+", "r3"}], ",", 
        RowBox[{"r1", "+", "r2", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD22", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p1", "+", "r1", "+", "r2", "+", "r3"}], ",", 
        RowBox[{"p1", "+", "r1", "+", "r2", "+", "r3"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DD23", " ", "->", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        RowBox[{"p2", "+", "r1", "+", "r2", "+", "r3"}], ",", 
        RowBox[{"p2", "+", "r1", "+", "r2", "+", "r3"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sps", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"p1", ",", "r1"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"p1", ",", "r2"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"p1", ",", "r3"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"p2", ",", "r1"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"p2", ",", "r2"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"p2", ",", "r3"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r1", ",", "r1"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r1", ",", "r2"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r1", ",", "r3"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r2", ",", "r2"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r2", ",", "r3"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{"r3", ",", "r3"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SPs2Ds", "[", "i", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FullFamilies", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
             RowBox[{
              RowBox[{"DD", "[", "a_", "]"}], ":>", " ", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<DD\>\"", "<>", 
                RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}]}], " ", ")"}], 
           "==", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FullFamilies", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
                 RowBox[{
                  RowBox[{"DD", "[", "a_", "]"}], ":>", " ", 
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<DD\>\"", "<>", 
                    RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}]}], " ", 
                ")"}], ")"}], "/.", "denoms"}], "/.", "kin"}], ")"}]}], "]"}],
          ",", "sps"}], "]"}], "//", "Flatten"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
      RowBox[{"Rule", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Collect", "[", 
         RowBox[{"b", ",", 
          RowBox[{"denoms", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Factor"}], "]"}]}],
        "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "FullFamilies", "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd2dd", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<DD\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], "]"}], " ", "->", " ", 
      RowBox[{"DD", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "denoms", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd2ddRev", " ", "=", " ", 
   RowBox[{"dd2dd", "/.", " ", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":>", " ", 
     RowBox[{"Rule", "[", 
      RowBox[{"b", ",", "a"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.974106824771556*^9, 3.974106824920216*^9}, {
  3.974108527743814*^9, 3.9741085445768547`*^9}, {3.9741085798867407`*^9, 
  3.974108599007465*^9}, {3.974108839229661*^9, 3.97410884913981*^9}, {
  3.974108879307149*^9, 3.974108879654224*^9}, {3.974108932721895*^9, 
  3.9741089850295887`*^9}, {3.9741090628992853`*^9, 3.9741090936251173`*^9}, {
  3.974109154283876*^9, 3.97410915440912*^9}, {3.974109203319357*^9, 
  3.974109203483268*^9}, {3.974111399010024*^9, 3.974111399145281*^9}, {
  3.974113333722918*^9, 3.974113341329337*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"a7e9c3eb-293d-4811-a3f1-450b267a6c81"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f_", "[", "mu_", "]"}], " ", 
     RowBox[{"g_", "[", "mu_", "]"}]}], "\[RuleDelayed]", 
    RowBox[{"sp", "[", 
     RowBox[{"f", ",", "g"}], "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"q_", "[", "mu_", "]"}], "2"], "\[RuleDelayed]", 
    RowBox[{"sp", "[", 
     RowBox[{"q", ",", "q"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.974109059364403*^9, 3.9741090951218243`*^9, 3.9741091555487413`*^9, 
   3.974109204518766*^9, {3.974113330429049*^9, 3.9741133443269997`*^9}, 
   3.9741140426438313`*^9, 3.974114788368999*^9, 3.9741150962197237`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"9f02d1ba-c56b-4127-ac8b-8012484f0ab9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"mu_", ",", "nu_", ",", "q_"}], "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"g", "[", 
      RowBox[{"mu", ",", "nu"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"q", "[", "mu", "]"}], " ", 
      RowBox[{"q", "[", "nu", "]"}]}], 
     RowBox[{"sp", "[", 
      RowBox[{"q", ",", "q"}], "]"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.974109059364403*^9, 3.9741090951218243`*^9, 3.9741091555487413`*^9, 
   3.974109204518766*^9, {3.974113330429049*^9, 3.9741133443269997`*^9}, 
   3.9741140426438313`*^9, 3.974114788368999*^9, 3.9741150962203283`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"a9ff2089-5dfc-42c9-b9d5-c9d6b678e3c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"sp", "[", 
     RowBox[{"p1", ",", "p1"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"sp", "[", 
     RowBox[{"p2", ",", "p2"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"sp", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], "\[Rule]", 
    FractionBox["s12", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.974109059364403*^9, 3.9741090951218243`*^9, 3.9741091555487413`*^9, 
   3.974109204518766*^9, {3.974113330429049*^9, 3.9741133443269997`*^9}, 
   3.9741140426438313`*^9, 3.974114788368999*^9, 3.9741150962207823`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"a472c491-a3e7-4c93-96f4-91f15412d43b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.974109030621359*^9, 3.974109043952594*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"3af5aec4-f54f-465f-b93c-b8674085f1e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mappings", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"index", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"todo", "=", 
     RowBox[{
      RowBox[{"intsallNoTopo1", "[", 
       RowBox[{"[", "index", "]"}], "]"}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"fam_", ",", "bin__"}], "]"}], "->", " ", 
       RowBox[{"INT", "[", 
        RowBox[{"fam", ",", " ", 
         RowBox[{"{", "bin", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "extract", " ", "family", " ", "and", " ", "sector", " ", "from", " ", 
      "the", " ", "requested", " ", "integral"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"FamSec", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"todo", " ", "/.", " ", 
        RowBox[{
         RowBox[{"a_", " ", "/;", " ", 
          RowBox[{"a", ">", " ", "1"}]}], " ", "->", " ", "1"}]}], " ", "/.", 
       " ", 
       RowBox[{
        RowBox[{"a_", " ", "/;", " ", 
         RowBox[{"a", "<", "0"}]}], " ", "->", " ", "0"}]}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"fam_", ",", 
         RowBox[{"{", "bin__", "}"}]}], "]"}], ":>", " ", 
       RowBox[{"{", 
        RowBox[{"fam", ",", " ", 
         RowBox[{"FromDigits", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "bin", "}"}], "//", "Reverse"}], ",", "2"}], "]"}]}],
         "}"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "whether", " ", "there", " ", "is", " ", "a", " ", 
      "symmetry", " ", "rule", " ", "for", " ", "it"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"pos", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"symmetryRelatedSectors", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{"FamSec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"FamSec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"{", "bin__", "}"}]}], "]"}], ",", " ", "r__"}], "}"}]}], 
       "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"pos", " ", "!=", " ", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"relation", "=", 
        RowBox[{
         RowBox[{"symmetryRelatedSectors", "[", 
          RowBox[{"[", "pos", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"this", " ", "is", " ", "all", " ", "we", " ", "need"}], " ", 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"mapping", " ", "of", " ", "all", " ", "the", " ", 
         RowBox[{"n", "[", "s", "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ns", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{"Equal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"relation", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                RowBox[{"_nisp", "->", " ", "0"}]}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"todo", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
                RowBox[{
                 RowBox[{"a_", " ", "/;", " ", 
                  RowBox[{"a", "<", "0"}]}], " ", "->", " ", "0"}]}], "  ", 
               ")"}]}], ",", " ", "0"}], "]"}], "]"}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"families", " ", "as", " ", "simple", " ", "numbers"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"famIn", " ", "=", " ", 
        RowBox[{
         RowBox[{"FamSec", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", "topoToN"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"famFin", "=", " ", 
        RowBox[{
         RowBox[{"relation", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "topoToN"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Find", " ", "crossing"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cross", " ", "=", " ", 
        RowBox[{"relation", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
        "Extract", " ", "ISPs", " ", "from", " ", "startint", " ", "int"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ispIn", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"todo", " ", "/.", " ", 
           RowBox[{
            RowBox[{"a_", " ", "/;", " ", 
             RowBox[{"a", ">", " ", "0"}]}], " ", "->", " ", "0"}]}], " ", "/.",
           " ", 
          RowBox[{
           RowBox[{"INT", "[", 
            RowBox[{"topo_", ",", 
             RowBox[{"{", "a__", "}"}]}], "]"}], ":>", " ", 
           RowBox[{
            RowBox[{"FullFamilies", "[", 
             RowBox[{"[", 
              RowBox[{"famIn", ",", "2"}], "]"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"{", "a", "}"}]}], ")"}]}]}]}], "/.", " ", 
         RowBox[{"List", " ", ":>", " ", "Times"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"ISP", " ", "mappings"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ispFin", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ispIn", " ", "/.", " ", "dd2ddRev"}], " ", "/.", " ",
                 "denoms"}], "/.", "cross"}], " ", "/.", " ", "kin"}], " ", "/.",
              " ", 
             RowBox[{"SPs2Ds", "[", "famFin", "]"}]}], " ", "/.", " ", 
            "dd2dd"}], " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DD", "[", "a_", "]"}], "/;", " ", 
              RowBox[{"a", "<", "6"}]}], " ", "->", " ", "0"}], "}"}]}], "//",
           "Expand"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FinalInt", " ", "=", " ", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"relation", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "  ", "/.", " ", 
                    RowBox[{
                    RowBox[{"n", "[", "a_", "]"}], " ", ":>", " ", 
                    RowBox[{
                    RowBox[{"nisp", "[", "a", "]"}], " ", "+", 
                    RowBox[{"n", "[", "a", "]"}]}]}]}], "/.", " ", "ns"}], 
                    ")"}], "ispFin"}], " ", "//", "Expand"}], ")"}], "//.", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"DD", "[", "index_", "]"}], "^", "pow_"}], " ", 
                   RowBox[{"INT", "[", 
                    RowBox[{"stuff__", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"a___", ",", 
                    RowBox[{
                    RowBox[{"nisp", "[", "index_", "]"}], "+", "c___"}], ",", 
                    " ", "b___"}], "}"}]}], "]"}]}], ":>", " ", 
                  RowBox[{"INT", "[", 
                   RowBox[{"stuff", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"nisp", "[", "index", "]"}], "-", "pow", " ", "+",
                     " ", "c"}], ",", "b"}], "}"}]}], "]"}]}]}], " ", " ", "//.",
                 " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DD", "[", "index_", "]"}], 
                  RowBox[{"INT", "[", 
                   RowBox[{"stuff__", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"a___", ",", 
                    RowBox[{
                    RowBox[{"nisp", "[", "index_", "]"}], "+", "c___"}], ",", 
                    " ", "b___"}], "}"}]}], "]"}]}], ":>", " ", 
                 RowBox[{"INT", "[", 
                  RowBox[{"stuff", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"nisp", "[", "index", "]"}], "-", "1", " ", "+", 
                    " ", "c"}], ",", "b"}], "}"}]}], "]"}]}]}], " ", "//.", 
               " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"DD", "[", "index_", "]"}], "^", "pow_"}], " ", 
                 RowBox[{"INT", "[", 
                  RowBox[{"stuff__", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"a___", ",", 
                    RowBox[{"nisp", "[", "index_", "]"}], ",", " ", "b___"}], 
                    "}"}]}], "]"}]}], ":>", " ", 
                RowBox[{"INT", "[", 
                 RowBox[{"stuff", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"nisp", "[", "index", "]"}], "-", "pow"}], " ", ",",
                     "b"}], "}"}]}], "]"}]}]}], "  ", "//.", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"DD", "[", "index_", "]"}], 
                RowBox[{"INT", "[", 
                 RowBox[{"stuff__", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"a___", ",", 
                    RowBox[{"nisp", "[", "index_", "]"}], ",", " ", "b___"}], 
                   "}"}]}], "]"}]}], ":>", " ", 
               RowBox[{"INT", "[", 
                RowBox[{"stuff", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", 
                   RowBox[{
                    RowBox[{"nisp", "[", "index", "]"}], "-", "1"}], " ", ",",
                    "b"}], "}"}]}], "]"}]}]}], " ", "/.", 
             RowBox[{"m2", " ", "->", " ", 
              RowBox[{"s12", " ", "z"}]}]}], "  ", "/.", " ", 
            RowBox[{"_nisp", " ", "->", " ", "0"}]}], ",", " ", 
           RowBox[{"{", "_INT", "}"}], ",", " ", "Factor"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{"fam_", ",", "sec_", ",", 
            RowBox[{"{", "bin__", "}"}]}], "]"}], "->", 
          RowBox[{"INT", "[", 
           RowBox[{"fam", ",", "bin"}], "]"}]}]}]}]}], ",", 
      RowBox[{
       RowBox[{"FinalInt", " ", "=", " ", "todo"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mappings", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"mappings", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{
           RowBox[{"intsallNoTopo1", "[", 
            RowBox[{"[", "index", "]"}], "]"}], ",", "FinalInt"}], "]"}], ",",
          " ", "cross"}], " ", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"index", ",", "500"}], "]"}], "===", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"Print", "[", "index", "]"}], ";", " ", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<./mappings.m\>\"", ",", " ", "mappings"}], "]"}]}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"index", ",", "1", ",", 
     RowBox[{"Length", "[", "intsallNoTopo1", "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.974106772469685*^9, 3.974106805927116*^9}, {
   3.9741083769409657`*^9, 3.9741084852938747`*^9}, 3.9741089940205317`*^9, {
   3.9741103088440523`*^9, 3.974110333917345*^9}, {3.9741105770969477`*^9, 
   3.974110578943318*^9}, {3.9741106266661777`*^9, 3.974110641567587*^9}, {
   3.9741110098536043`*^9, 3.974111010104611*^9}, {3.9741110981665792`*^9, 
   3.9741111180101833`*^9}, 3.9741111767645187`*^9, {3.97411129626189*^9, 
   3.974111390063752*^9}, {3.974111646948132*^9, 3.974111687017283*^9}, {
   3.9741122459142647`*^9, 3.9741123081535997`*^9}, {3.974112349789736*^9, 
   3.974112436370474*^9}, {3.974113350460924*^9, 3.974113384869217*^9}, {
   3.97411406420578*^9, 3.974114184907289*^9}, {3.9741146198488483`*^9, 
   3.974114681563364*^9}, {3.97411478276611*^9, 3.974114791586646*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"37d33f41-5cbd-44f7-bdda-15249faf2ad4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mappings", " ", "=", " ", 
   RowBox[{"mappings", " ", "/.", " ", 
    RowBox[{"s12", " ", "->", " ", 
     RowBox[{"1", "/", "z"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.974177224589176*^9, 3.974177234253293*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"6125ebf6-06af-452b-bb7d-ea6bc03cb382"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<./mappings.m\>\"", ",", " ", "mappings"}], "]"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"a3c267be-85b9-4920-ac54-d83fb190e503"],

Cell[BoxData["\<\"./mappings.m\"\>"], "Output",
 CellChangeTimes->{3.974177289752681*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"cd5846ad-f16c-4dc0-9ffd-146b4c3df352"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9741858546667633`*^9, 
  3.974185855563342*^9}},ExpressionUUID->"ff7384d4-fef0-4b25-a234-\
a035301e9a78"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.974182662505962*^9, 3.974182679517271*^9}, {
  3.974184254692257*^9, 
  3.974184316078842*^9}},ExpressionUUID->"21aaeaa6-abc0-4bba-b6f6-\
edee89d76213"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.974177253757738*^9, 
  3.974177257372745*^9}},ExpressionUUID->"ea6eb4a9-4f42-4072-8ca5-\
49c57a22c987"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.974114853252508*^9, 3.9741148804896593`*^9}, 
   3.974184253078958*^9, {3.974184300999618*^9, 
   3.974184311034226*^9}},ExpressionUUID->"292cb030-68c6-41e4-827e-\
d62047d929a8"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Some", " ", "checks"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", "*)"}]], "Input",
 CellChangeTimes->{
  3.974114134226696*^9, {3.974114197818742*^9, 
   3.9741142045590773`*^9}},ExpressionUUID->"9faad457-e3f6-457c-98c1-\
bdeae970a357"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"todo", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"mappings", "[", 
        RowBox[{"[", "tocheck", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"a_", ",", "bin__"}], "]"}], "->", " ", 
       RowBox[{"INT", "[", 
        RowBox[{"a", ",", 
         RowBox[{"{", "bin", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"lhs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"FullFamilies", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"todo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
                  "topoToN"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "^", 
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"todo", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ")"}]}], " ", "/.",
              " ", 
             RowBox[{"List", " ", "->", " ", "Times"}]}], ")"}], " ", "/.", 
           " ", "dd2ddRev"}], " ", "/.", " ", "denoms"}], "  ", "/.", 
         RowBox[{
          RowBox[{"mappings", "[", 
           RowBox[{"[", "tocheck", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "/.", " ", "kin"}], " ", "/.", 
       " ", 
       RowBox[{"m2", " ", "->", " ", 
        RowBox[{"s12", " ", "z"}]}]}], " ", "//", " ", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsrhs", "=", 
     RowBox[{
      RowBox[{"Union", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mappings", "[", 
            RowBox[{"[", "tocheck", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "2"}], " ", ",", " ", 
         "_INT", ",", " ", "\[Infinity]"}], "]"}]}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"a_", ",", "bin__"}], "]"}], "->", " ", 
       RowBox[{"INT", "[", 
        RowBox[{"a", ",", 
         RowBox[{"{", "bin", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"props", "=", 
     RowBox[{
      RowBox[{"FullFamilies", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"intsrhs", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", " ", "topoToN"}], 
        "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"raised", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"props", ",", "#"}], "]"}], "&"}], "/@", " ", 
      RowBox[{"(", 
       RowBox[{"intsrhs", "/.", " ", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{"a_", ",", "b_", ",", " ", 
           RowBox[{"{", "bin__", "}"}]}], "]"}], ":>", " ", 
         RowBox[{"-", 
          RowBox[{"{", "bin", "}"}]}]}]}], ")"}]}]}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"raised", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"raised", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/.", " ", 
        RowBox[{"List", " ", "->", " ", "Times"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "raised", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"replacement", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"Rule", "[", 
       RowBox[{"intsrhs", ",", "raised"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rhs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mappings", "[", 
              RowBox[{"[", "tocheck", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
            "replacement"}], " ", "/.", " ", "dd2ddRev"}], " ", "/.", " ", 
          "denoms"}], " ", "/.", " ", "kin"}], " ", "/.", " ", 
        RowBox[{"m2", " ", "->", 
         RowBox[{"s12", " ", "z"}]}]}], " ", "//.", " ", 
       RowBox[{"s12", " ", "->", " ", 
        RowBox[{"1", "/", "z"}]}]}], " ", "//", " ", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rhs", "=", 
     RowBox[{"rhs", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"lhs", "=", 
     RowBox[{"lhs", "//", " ", "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"tocheck", ",", " ", "\"\<     \>\"", ",", 
      RowBox[{
       RowBox[{"Factor", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DD", "[", "1", "]"}], 
          RowBox[{"DD", "[", "2", "]"}], 
          RowBox[{"DD", "[", "3", "]"}], 
          RowBox[{"DD", "[", "4", "]"}], 
          RowBox[{"DD", "[", "5", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"rhs", "-", "lhs"}], "//", "Simplify"}], ")"}], " ",
                 "/.", " ", 
                RowBox[{"SPs2Ds", "[", 
                 RowBox[{
                  RowBox[{"intsrhs", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", 
                  "topoToN"}], "]"}]}], " ", "//", "Simplify"}], ")"}], " ", "/.",
              " ", "dd2dd"}], " ", "//", "Expand"}], ")"}]}], ")"}], "]"}], 
       " ", "/.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"DD", "[", "a_", "]"}], "/;", 
         RowBox[{"a", "<", "6"}]}], "->", " ", "0"}]}]}], "]"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"tocheck", ",", " ", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.974109226089115*^9, 3.97410923828824*^9}, {
   3.974109457540927*^9, 3.9741097576881104`*^9}, {3.9741101074455643`*^9, 
   3.974110172050507*^9}, {3.974110281662348*^9, 3.974110292344055*^9}, {
   3.974110340041149*^9, 3.974110532174636*^9}, {3.974110586402487*^9, 
   3.974110598763792*^9}, {3.974111030650968*^9, 3.9741110717468*^9}, {
   3.974112215751471*^9, 3.974112215896391*^9}, 3.9741123276916113`*^9, {
   3.974112364470483*^9, 3.974112367139473*^9}, {3.974114283429093*^9, 
   3.9741145080344067`*^9}, {3.974114549545938*^9, 3.974114588871615*^9}, {
   3.974119077386302*^9, 3.974119081811754*^9}, {3.974185894392404*^9, 
   3.9741858997966843`*^9}},ExpressionUUID->"3e5fcc02-5cf7-4cb4-8f8d-\
9c08e465c49c"],

Cell[CellGroupData[{

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114590408662*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"d73880d1-8af6-447f-9364-b9bf26d457db"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114591274399*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"f06aadd2-c058-44fb-9b80-d5e428cf85cd"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114596588872*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"6d9e26d8-9224-4167-8ca6-b4415b105370"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114596897277*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"3b6eaae1-9c19-404d-91b2-902517bf34fd"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114596967073*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"82178606-7f1c-4a60-a7ed-56a1fd070fe4"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114601401416*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"fed81aa7-1bb0-4b96-b475-6d46e9e8d304"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.9741146028407707`*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"224a3670-2ea6-4bfa-b4b5-c8a0b6a9890c"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114603768799*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"2c97cc8a-0937-41be-9eb9-766cd3308a7d"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114609243972*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"6d29ac4b-598f-42a5-b3bd-75b348323bad"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.974114587643168*^9, 3.974114609935013*^9}},
 CellLabel->
  "During evaluation of \
In[215]:=",ExpressionUUID->"dee83d27-bc85-4494-8000-ffabe7aa6c42"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"allISPmap", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"counter", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"allISPmap", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"allISPmap", ",", 
         RowBox[{"{", 
          RowBox[{"in", ",", " ", "out", ",", "cr", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"FullFamilies", "[", 
                  RowBox[{"[", 
                   RowBox[{"in", ",", "2", ",", 
                    RowBox[{"6", ";;"}]}], "]"}], "]"}], "  ", "/.", " ", 
                 RowBox[{
                  RowBox[{"DD", "[", "a_", "]"}], ":>", " ", 
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<DD\>\"", "<>", 
                    RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"FullFamilies", "[", 
                    RowBox[{"[", 
                    RowBox[{"in", ",", "2", ",", 
                    RowBox[{"6", ";;"}]}], "]"}], "]"}], "  ", "/.", " ", 
                    RowBox[{
                    RowBox[{"DD", "[", "a_", "]"}], ":>", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<DD\>\"", "<>", 
                    RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}]}], " ", "/.",
                     " ", "denoms"}], " ", "/.", " ", "cr"}], "/.", " ", 
                    RowBox[{"SPs2Ds", "[", "out", "]"}]}], "/.", " ", "kin"}],
                   "//", " ", "Simplify"}], "//", "Expand"}]}], "]"}], "]"}], 
             "/.", "dd2dd"}], ")"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"counter", " ", "=", " ", 
       RowBox[{"counter", " ", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"counter", ",", " ", "100"}], "]"}], "===", "0"}], ",", 
        RowBox[{"Print", "[", "counter", "]"}]}], "]"}], ";"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"in", ",", "2", ",", 
       RowBox[{"Length", "[", "FullFamilies", "]"}]}], " ", "}"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"out", ",", "1", ",", " ", "in"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"cr", ",", "permutations"}], "}"}]}], "]"}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.974107826729351*^9, 3.9741081353473454`*^9}, {
   3.974108188872365*^9, 3.974108189867693*^9}, 3.974108306871677*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"e47a29d0-a9d0-42d2-9561-1321c4931cac"]
},
Evaluator->"New Kernel",
WindowSize->{1528, 1387},
WindowMargins->{{1514, Automatic}, {Automatic, -13}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.25 Inherited,
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"72c6df03-b870-4f7b-9c2d-ba0b7ccd828a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 293, 5, 36, "Input",ExpressionUUID->"b556ad24-c42c-47b9-87a8-161a44cd21e1"],
Cell[CellGroupData[{
Cell[876, 29, 296, 5, 36, "Input",ExpressionUUID->"1747bd0d-604b-4f10-99e7-0fe6fa4529fc"],
Cell[1175, 36, 5838, 83, 41, "Output",ExpressionUUID->"bc745a2c-7261-43c8-b6f3-9d86b14dcc13"]
}, Open  ]],
Cell[7028, 122, 333, 8, 36, "Input",ExpressionUUID->"b6e19f8b-9906-4a7c-8f5e-adf550d52f12"],
Cell[7364, 132, 3491, 95, 266, "Input",ExpressionUUID->"e489dccb-fc0c-4cc8-8c81-4ec0f8e6300b"],
Cell[10858, 229, 559, 15, 62, "Input",ExpressionUUID->"6cb6b0b4-10c5-4c7f-9ac1-6e42f3571ba5"],
Cell[CellGroupData[{
Cell[11442, 248, 143, 2, 36, "Input",ExpressionUUID->"dde2e4c4-0179-4e3f-86ea-3bcbf676f011"],
Cell[11588, 252, 206, 3, 41, "Output",ExpressionUUID->"f94cbd75-cbef-4101-ab4f-6bd1efc938f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11831, 260, 248, 5, 36, "Input",ExpressionUUID->"ffad7af3-783c-486e-856e-8c7b7d63477c"],
Cell[12082, 267, 2489, 47, 118, "Output",ExpressionUUID->"9889dd36-1719-4bc8-8e94-279aa609b6a9"]
}, Open  ]],
Cell[14586, 317, 639, 15, 36, "Input",ExpressionUUID->"0523a8ab-a457-479e-9486-44f54619357b"],
Cell[CellGroupData[{
Cell[15250, 336, 14829, 403, 1211, "Input",ExpressionUUID->"a7e9c3eb-293d-4811-a3f1-450b267a6c81"],
Cell[30082, 741, 734, 18, 44, "Output",ExpressionUUID->"9f02d1ba-c56b-4127-ac8b-8012484f0ab9"],
Cell[30819, 761, 747, 19, 58, "Output",ExpressionUUID->"a9ff2089-5dfc-42c9-b9d5-c9d6b678e3c2"],
Cell[31569, 782, 695, 17, 55, "Output",ExpressionUUID->"a472c491-a3e7-4c93-96f4-91f15412d43b"]
}, Open  ]],
Cell[32279, 802, 175, 3, 36, "Input",ExpressionUUID->"3af5aec4-f54f-465f-b93c-b8674085f1e0"],
Cell[32457, 807, 13109, 313, 930, "Input",ExpressionUUID->"37d33f41-5cbd-44f7-bdda-15249faf2ad4"],
Cell[45569, 1122, 335, 7, 36, "Input",ExpressionUUID->"6125ebf6-06af-452b-bb7d-ea6bc03cb382"],
Cell[CellGroupData[{
Cell[45929, 1133, 192, 3, 36, "Input",ExpressionUUID->"a3c267be-85b9-4920-ac54-d83fb190e503"],
Cell[46124, 1138, 168, 2, 41, "Output",ExpressionUUID->"cd5846ad-f16c-4dc0-9ffd-146b4c3df352"]
}, Open  ]],
Cell[46307, 1143, 154, 3, 36, "Input",ExpressionUUID->"ff7384d4-fef0-4b25-a234-a035301e9a78"],
Cell[46464, 1148, 220, 4, 62, "Input",ExpressionUUID->"21aaeaa6-abc0-4bba-b6f6-edee89d76213"],
Cell[46687, 1154, 152, 3, 36, "Input",ExpressionUUID->"ea6eb4a9-4f42-4072-8ca5-49c57a22c987"],
Cell[46842, 1159, 227, 4, 36, "Input",ExpressionUUID->"292cb030-68c6-41e4-827e-d62047d929a8"],
Cell[47072, 1165, 336, 7, 138, "Input",ExpressionUUID->"9faad457-e3f6-457c-98c1-bdeae970a357"],
Cell[CellGroupData[{
Cell[47433, 1176, 6927, 180, 394, "Input",ExpressionUUID->"3e5fcc02-5cf7-4cb4-8f8d-9c08e465c49c"],
Cell[CellGroupData[{
Cell[54385, 1360, 199, 4, 28, "Print",ExpressionUUID->"d73880d1-8af6-447f-9364-b9bf26d457db"],
Cell[54587, 1366, 199, 4, 28, "Print",ExpressionUUID->"f06aadd2-c058-44fb-9b80-d5e428cf85cd"],
Cell[54789, 1372, 199, 4, 28, "Print",ExpressionUUID->"6d9e26d8-9224-4167-8ca6-b4415b105370"],
Cell[54991, 1378, 199, 4, 28, "Print",ExpressionUUID->"3b6eaae1-9c19-404d-91b2-902517bf34fd"],
Cell[55193, 1384, 199, 4, 28, "Print",ExpressionUUID->"82178606-7f1c-4a60-a7ed-56a1fd070fe4"],
Cell[55395, 1390, 199, 4, 28, "Print",ExpressionUUID->"fed81aa7-1bb0-4b96-b475-6d46e9e8d304"],
Cell[55597, 1396, 201, 4, 28, "Print",ExpressionUUID->"224a3670-2ea6-4bfa-b4b5-c8a0b6a9890c"],
Cell[55801, 1402, 199, 4, 28, "Print",ExpressionUUID->"2c97cc8a-0937-41be-9eb9-766cd3308a7d"],
Cell[56003, 1408, 199, 4, 28, "Print",ExpressionUUID->"6d29ac4b-598f-42a5-b3bd-75b348323bad"],
Cell[56205, 1414, 199, 4, 28, "Print",ExpressionUUID->"dee83d27-bc85-4494-8000-ffabe7aa6c42"]
}, Open  ]]
}, Open  ]],
Cell[56431, 1422, 2975, 69, 266, "Input",ExpressionUUID->"e47a29d0-a9d0-42d2-9561-1321c4931cac"]
}
]
*)

